# 远程连接配置指南

本指南说明如何让朋友在他的电脑上部署前端，连接到你电脑上的后端服务。

## 前提条件

- 你和你的朋友必须在**同一个局域网**（连接同一个 WiFi）
- 后端服务器（你的电脑）的本地 IP：**172.16.2.40**
- 后端服务端口：**5002**

---

## 一、后端服务器（你的电脑）配置

### 1. 启动后端服务

```bash
cd video-danmaku-site/backend
npm install  # 首次运行需要安装依赖
npm start
```

服务应该显示：`服务器运行在端口 5002`

### 2. 配置防火墙

**macOS 系统：**
1. 打开"系统设置" → "网络" → "防火墙"
2. 如果防火墙已开启，点击"选项"
3. 确保允许 Node.js 或你的终端应用接受传入连接

**Windows 系统：**
1. 打开"控制面板" → "Windows Defender 防火墙"
2. 点击"允许应用通过防火墙"
3. 添加 Node.js 或允许端口 5002

### 3. 测试后端是否可访问

在你的电脑上打开浏览器，访问：
```
http://172.16.2.40:5002
```

应该看到：`{"message":"视频弹幕网站 API"}`

---

## 二、前端（你朋友的电脑）配置

### 1. 克隆项目

```bash
git clone <你的GitHub仓库地址>
cd video-danmaku-site/frontend
```

### 2. 安装依赖

```bash
npm install
```

### 3. 配置后端地址

创建 `.env` 文件：

```bash
cp .env.example .env
```

编辑 `.env` 文件，修改后端地址：

```env
REACT_APP_API_BASE_URL=http://172.16.2.40:5002/api
```

**重要：** 将 `172.16.2.40` 替换为你电脑的实际 IP 地址

### 4. 启动前端

```bash
npm start
```

前端将运行在 `http://localhost:3000`

---

## 三、验证连接

### 测试步骤：

1. 在你朋友的浏览器中打开 `http://localhost:3000`
2. 尝试注册/登录账号
3. 尝试上传视频或发送弹幕
4. 如果功能正常，说明连接成功！

### 常见问题排查：

**问题1：无法连接到后端**
- 检查是否在同一局域网
- 检查防火墙设置
- 确认后端服务正在运行
- 尝试 ping 后端 IP：`ping 172.16.2.40`

**问题2：CORS 错误**
- 后端已配置允许所有来源（`origin: '*'`）
- 如果仍有问题，检查浏览器控制台的具体错误信息

**问题3：API 请求失败**
- 打开浏览器开发者工具（F12）
- 查看 Network 标签，检查请求是否发送到正确的地址
- 确认 `.env` 文件中的地址配置正确

---

## 四、获取你的 IP 地址

如果你的 IP 地址改变了，可以用以下命令查看：

**macOS/Linux：**
```bash
ifconfig | grep "inet " | grep -v 127.0.0.1
```

**Windows：**
```bash
ipconfig
```

查找 "IPv4 地址" 或 "inet" 开头的行，通常是 `192.168.x.x` 或 `172.16.x.x` 格式。

---

## 五、注意事项

1. **数据库连接**：后端使用本地 MongoDB，你朋友的前端只能访问你电脑上的数据
2. **文件上传**：上传的视频文件会保存在你的电脑上（后端服务器）
3. **网络稳定性**：确保 WiFi 连接稳定，否则可能出现连接中断
4. **安全性**：这种配置仅适用于局域网内的开发测试，不要暴露到公网

---

## 六、生产环境部署（可选）

如果需要让朋友通过互联网访问（不在同一局域网），需要：

1. 使用云服务器部署后端（如阿里云、腾讯云、AWS）
2. 配置域名和 HTTPS
3. 修改前端 `.env` 文件为云服务器地址
4. 配置生产环境的数据库和安全设置

这超出了本地开发的范围，建议先在局域网内测试成功后再考虑。
